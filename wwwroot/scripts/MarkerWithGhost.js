!function(t,i){"use strict";"function"==typeof define&&define.amd?define(["jquery","SlidingMarker"],i.bind(null,t)):"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports=i(t,require("jquery"),require("SlidingMarker")):t.MarkerWithGhost=i(t,t.jQuery,t.SlidingMarker)}(this,function(t,i,o){"use strict";i=i||{},i.extend=i.extend||function s(t){return Array.prototype.slice.call(arguments,1).forEach(function(i){if(i)for(var o in i)i[o]&&i[o].constructor===Object?t[o]&&t[o].constructor!==Object?t[o]=i[o]:(t[o]=t[o]||{},s(t[o],i[o])):t[o]=i[o]}),t};var n=function(t,i){function o(){}o.prototype=i.prototype,t.superClass_=i.prototype,t.prototype=new o,t.prototype.constructor=t},e=function(t){this.ghostPosition=null,this.ghostAnimationPosition=null,o.call(this,t),this.bindTo("ghostPosition",this,"position"),this.bindTo("ghostAnimationPosition",this._instance,"position")};return n(e,o),i.extend(e.prototype,{_isGhost:!1,set:function(t,i){if("position"===t)this._turnGhostModeOff();else if("ghostPosition"===t)return this._turnGhostModeOn(),this.originalSet("ghostPosition",i),void o.prototype._setInstancePositionAnimated.call(this,i);o.prototype.set.apply(this,arguments)},_rebindEventListener:null,_turnGhostModeOn:function(){this._isGhost||(this._rebindEventListener||(google.maps.event.removeListener(this._rebindEventListener),this._rebindEventListener=null),this.unbind("animationPosition"),this.unbind("ghostPosition"),this._isGhost=!0)},_turnGhostModeOff:function(){var t=this;this._isGhost&&(this._rebindEventListener=google.maps.event.addListener(this._instance,"position_changed",function(){t.getPosition()===t._instance.getPosition()&&(t.bindTo("animationPosition",t._instance,"position"),google.maps.event.removeListener(t._rebindEventListener),t._rebindEventListener=null)}),this.bindTo("ghostPosition",this,"position"),this._isGhost=!1)},getGhostPosition:function(){return this.get("ghostPosition")},setGhostPosition:function(t){this.set("ghostPosition",t)},getGhostAnimationPosition:function(){return this.get("ghostAnimationPosition")},position_changed:function(){this._turnGhostModeOff(),o.prototype.position_changed.apply(this,arguments)}}),google.maps.MarkerGhost=google.maps.Marker,e.initializeGlobally=function(){google.maps.MarkerGhost=e},e});